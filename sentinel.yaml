# yaml-language-server: $schema=sentinel.schema.json

host: localhost
port: 3000
backends:
  - load_balancer: round-robin
    patterns:
      - from: /todos
        to: /todos
      - from: /todos/*
        to: /todos/$1
    middlewares:
      - name: rate-limiter
        config:
          limit: 10
          burst: 0
          expires: 30s
      - name: auth-n
        config:
          alg: RS256
          jwks_url: https://example.com/.well-known/jwks.json
          jwt_secret: your-super-secret-key
          propagate_claims:
            - from: sub
              to: X-User
    services:
      - url: http://localhost:8010
      - url: http://localhost:8020
      - url: http://localhost:8030
  - load_balancer: random
    methods: ["OPTIONS", "GET", "POST"]
    patterns:
      - from: /todos-v2
        to: /todos
      - from: /todos-v2/*
        to: /todos/$1
    services:
      - url: http://localhost:8010
      - url: http://localhost:8020
      - url: http://localhost:8030
